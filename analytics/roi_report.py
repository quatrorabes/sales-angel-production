#!/usr/bin/env python3

# roi_report.py - One-page ROI summary for stakeholders

import sqlite3
from datetime import datetime

def generate_roi_report():
		"""Generate executive ROI summary"""
	
		conn = sqlite3.connect('sales_angel.db')
	
		enriched = conn.execute("SELECT COUNT(*) FROM contacts WHERE enriched = 1").fetchone()[0]
		with_content = conn.execute("SELECT COUNT(*) FROM contacts WHERE email_1_subject IS NOT NULL").fetchone()[0]
	
		# Read activity from CSV
		try:
				import csv
				with open('daily_tracker.csv', 'r') as f:
						reader = csv.DictReader(f)
						activities = list(reader)
					
				emails = len([a for a in activities if a.get('Channel') == 'Email'])
				responses = len([a for a in activities if 'response' in a.get('Channel', '').lower()])
				meetings = len([a for a in activities if 'meeting' in a.get('Status', '').lower()])
		except:
				emails, responses, meetings = 0, 0, 0
			
		# Costs
		total_cost = (enriched * 0.15) + (with_content * 0.05)
	
		# Value
		pipeline_low = meetings * 45000 * 0.10
		pipeline_high = meetings * 450000 * 0.10
	
		# Create report
		report = f"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    SALES ANGEL ROI REPORT                            â•‘
â•‘                    {datetime.now().strftime('%B %d, %Y')}                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ACTIVITY SUMMARY
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

	Contacts Enriched:        {enriched:>5}
	Content Generated:        {with_content:>5} contacts ({with_content * 6:>5} pieces)
	
	Outreach Executed:
		â€¢ Emails Sent:          {emails:>5}
		â€¢ Responses Received:   {responses:>5} ({(responses/emails*100) if emails > 0 else 0:>4.1f}%)
		â€¢ Meetings Booked:      {meetings:>5}

ğŸ’° FINANCIAL IMPACT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

	Investment:               ${total_cost:>10,.2f}
	
	Pipeline Created:
		â€¢ Conservative:         ${pipeline_low:>10,.0f}
		â€¢ Optimistic:           ${pipeline_high:>10,.0f}
	
	Return on Investment:
		â€¢ Low Scenario:         {((pipeline_low-total_cost)/total_cost*100) if total_cost > 0 else 0:>10,.0f}%
		â€¢ High Scenario:        {((pipeline_high-total_cost)/total_cost*100) if total_cost > 0 else 0:>10,.0f}%
	
	Cost Efficiency:
		â€¢ Per Enrichment:       ${total_cost/enriched if enriched > 0 else 0:>10,.2f}
		â€¢ Per Email:            ${total_cost/emails if emails > 0 else 0:>10,.2f}
		â€¢ Per Response:         ${total_cost/responses if responses > 0 else 0:>10,.2f}
		â€¢ Per Meeting:          ${total_cost/meetings if meetings > 0 else 0:>10,.2f}

ğŸ¯ PERFORMANCE BENCHMARKS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

	Email Response Rate:      {(responses/emails*100) if emails > 0 else 0:>6.1f}%  (Target: 25%)
	Meeting Conversion:       {(meetings/responses*100) if responses > 0 else 0:>6.1f}%  (Target: 30%)
	Cost per Meeting:         ${total_cost/meetings if meetings > 0 else 0:>8,.2f}  (Industry: $200-500)

ğŸ“ˆ NEXT STEPS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

	1. Scale enrichment to 50+ contacts
	2. Maintain 3+ emails sent per day
	3. Follow up on all responses within 24 hours
	4. Track closed deals to calculate actual ROI

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Generated by Sales Angel v3.0 | For questions: [your email]
"""

		conn.close()
		return report
		
if __name__ == "__main__":
		print(generate_roi_report())
	